# genRTL AI UI优化测试指南

## 测试日期：2025-12-31

本文档提供了测试最新UI改进的详细步骤。

---

## 测试环境准备

1. **编译客户端程序**
   ```powershell
   cd D:\xroting\avlog\genRTL
   # 按照项目README中的编译步骤进行编译
   ```

2. **启动SaaS后端**（如果使用SaaS模式）
   ```powershell
   cd D:\xroting\avlog\genRTL-saas
   npm run dev
   ```

3. **启动VSCode/VSCodium**
   - 打开genRTL工作区
   - 确保genRTL AI扩展已激活

---

## 功能测试清单

### 1. ✅ 视图标题栏按钮测试

**测试位置**：genRTL AI侧边栏的标题栏（视图容器标题）

**测试步骤**：
1. 查看genRTL AI侧边栏的标题栏
2. 确认看到两个按钮：
   - ➕ New Chat 按钮（加号图标）
   - 📜 History 按钮（历史图标）

**预期结果**：
- ✓ 按钮显示在视图标题栏的右侧
- ✓ 点击New Chat创建新对话
- ✓ 点击History打开历史记录页面
- ✓ 按钮样式与VSCode原生UI一致

**截图位置**：视图标题栏右上角

---

### 2. ✅ HeaderBar中的New Chat按钮测试

**测试位置**：AI助手聊天界面顶部的HeaderBar

**测试步骤**：
1. 查看HeaderBar右侧的按钮组
2. 确认New Chat按钮始终可见（不论是否在SaaS模式下）
3. Hover查看tooltip显示"New Chat"
4. 点击按钮创建新对话

**预期结果**：
- ✓ New Chat按钮在SaaS模式下可见
- ✓ New Chat按钮在非SaaS模式下可见
- ✓ Tooltip显示"New Chat"而不是"New Task"
- ✓ 点击后清空当前对话，开始新对话

---

### 3. ✅ 历史对话下拉选择器测试

**测试位置**：HeaderBar右侧，History按钮旁边

**测试步骤**：
1. 在HeaderBar右侧找到下拉箭头按钮（ChevronDown图标）
2. Hover查看tooltip显示"Recent History"
3. 点击打开下拉菜单
4. 验证显示的内容：
   - "Recent Conversations"标题
   - 最多10条历史记录
   - 每条记录显示：时间、标题、模型（如果有）
   - 收藏的对话显示金色星标
   - 底部"View All History"按钮
5. 点击某条历史记录切换到该对话
6. 点击"View All History"打开完整历史页面

**预期结果**：
- ✓ 下拉菜单正确显示
- ✓ 时间格式正确（相对时间：如"2h ago"）
- ✓ 长标题正确截断（最多80字符）
- ✓ 收藏标识正确显示
- ✓ 点击记录能正确切换对话
- ✓ 下拉菜单在点击外部时自动关闭

**测试场景**：
- **空历史**：确认显示"No history yet"
- **有历史**：确认显示最近10条记录
- **收藏对话**：确认星标正确显示

---

### 4. ✅ 多页面Tab栏测试

**测试位置**：HeaderBar下方的Tab栏

**测试步骤**：
1. 创建一个新任务（开始一个对话）
2. 观察HeaderBar下方出现的Tab栏
3. 验证当前任务显示为活动tab
4. Hover到活动tab上，确认显示关闭按钮（X图标）
5. 查看是否显示最近的4个历史任务作为tab
6. 点击某个历史任务tab切换到该对话
7. 点击Tab栏右侧的"+"按钮创建新chat
8. 测试tab的滚动行为（当tab数量较多时）

**预期结果**：
- ✓ 当前任务显示为高亮的活动tab
- ✓ tab标题正确截断（最多30字符）
- ✓ Hover时显示关闭按钮
- ✓ 点击tab能正确切换对话
- ✓ 点击"+"按钮创建新对话
- ✓ tab栏支持横向滚动（如需要）
- ✓ 过渡动画流畅

**测试场景**：
- **单个tab**：只有当前任务
- **多个tab**：当前任务 + 历史任务
- **无任务**：Tab栏不显示（空欢迎页面）

---

## 视觉检查清单

### 布局检查
- [ ] HeaderBar与Tab栏之间没有间隙
- [ ] Tab栏与聊天内容之间有适当分隔
- [ ] 按钮对齐一致
- [ ] 间距合理

### 颜色和主题
- [ ] 按钮颜色符合VSCode主题
- [ ] Hover效果明显但不突兀
- [ ] 活动tab与非活动tab有明显区别
- [ ] 下拉菜单背景色正确

### 响应性
- [ ] 按钮在不同窗口大小下正常显示
- [ ] Tab栏在窗口较窄时支持滚动
- [ ] 下拉菜单位置正确（不超出视口）

---

## 交互测试清单

### 键盘导航
- [ ] Tab键能正确导航到各个按钮
- [ ] Enter键能激活按钮
- [ ] Esc键能关闭下拉菜单

### 鼠标交互
- [ ] 单击按钮正确响应
- [ ] Hover效果正确显示
- [ ] 下拉菜单点击外部关闭

### 性能
- [ ] 打开下拉菜单无明显延迟
- [ ] 切换tab流畅
- [ ] 滚动tab栏流畅

---

## 已知限制

1. **Maximize按钮名称**：
   - VSCode原生的"Maximize Secondary side bar size"按钮无法直接重命名
   - 需要通过修改VSCode语言包或源码实现
   - 当前方案通过添加视图标题栏按钮提供替代方案

2. **多任务并发**：
   - Tab切换功能在UI层面实现
   - 底层仍然是单任务模式
   - 完整的多任务并发需要后端架构支持

---

## 回归测试

确保以下现有功能仍然正常工作：

- [ ] 创建新任务
- [ ] 发送消息
- [ ] 查看历史记录（完整页面）
- [ ] MCP服务器配置
- [ ] 设置页面
- [ ] Agent/Plan模式切换（非SaaS模式）
- [ ] Orchestrator状态显示
- [ ] 代码块展开/折叠

---

## 问题报告格式

如果发现问题，请按以下格式报告：

```
## 问题标题

**发现位置**：[具体位置]
**复现步骤**：
1. 步骤1
2. 步骤2
3. 步骤3

**预期结果**：[应该发生什么]
**实际结果**：[实际发生了什么]
**截图**：[如果可能，提供截图]
**环境信息**：
- OS: [操作系统版本]
- VSCode版本: [版本号]
- genRTL版本: [版本号]
```

---

## 测试完成确认

- [ ] 所有功能测试通过
- [ ] 视觉检查通过
- [ ] 交互测试通过
- [ ] 回归测试通过
- [ ] 无严重性能问题
- [ ] 无明显的UI/UX问题

**测试人员签名**：_______________
**测试日期**：_______________
**通过/需要修复**：_______________

